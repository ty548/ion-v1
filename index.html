<!DOCTYPE html>
<html lang="ko" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ion - 연결된 기억, 영원한 교감</title>
    
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Fonts -->
    <link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">

    <style>
        /* --- Global Styles and CSS Variables --- */
        :root {
            --primary: #4F46E5;
            --secondary: #14B8A6;
            --accent: #EC4899;
            --bg-dark: #111827;
            --bg-light: #F9FAFB;
            --text-main: #F9FAFB;
            --text-dark: #1F2937;
            --glass-bg: rgba(31, 41, 55, 0.5);
            --glass-border: rgba(55, 65, 81, 0.5);
        }

        body {
            font-family: 'Pretendard', 'Inter', sans-serif;
            background-color: var(--bg-dark);
            color: var(--text-main);
            overflow-x: hidden;
        }

        h1, h2, h3, h4, h5, h6 {
            font-family: 'Pretendard', 'Inter', sans-serif;
            font-weight: 700;
        }

        /* --- Custom Utility Classes --- */
        .glassmorphism {
            background: var(--glass-bg);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border-bottom: 1px solid var(--glass-border);
        }

        .section-light {
            background-color: var(--bg-light);
            color: var(--text-dark);
        }

        .section-dark {
             background-color: var(--bg-dark);
             color: var(--text-main);
        }

        .gradient-text {
            background-image: linear-gradient(to right, var(--primary), var(--secondary), var(--accent));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        /* --- Animations --- */
        .floating {
            animation: float 6s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
        }

        .reveal {
            opacity: 0;
            transform: translateY(40px);
            transition: opacity 1s ease-out, transform 1s ease-out;
        }

        .reveal.active {
            opacity: 1;
            transform: translateY(0);
        }

        details > summary { list-style: none; }
        details > summary::-webkit-details-marker { display: none; }
        details[open] summary .plus-icon { transform: rotate(45deg); }
        .plus-icon { transition: transform 0.3s ease-in-out; }

        #hero-bg-animation canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        .loading-spinner {
            border: 3px solid rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            border-top: 3px solid var(--primary);
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* --- Modals --- */
        .modal {
            display: none;
            position: fixed;
            z-index: 100;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            backdrop-filter: blur(5px);
        }

        .modal.show {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background-color: var(--bg-dark);
            padding: 2rem;
            border-radius: 1rem;
            width: 90%;
            max-width: 500px;
            position: relative;
            animation: modalSlideIn 0.3s ease-out;
        }

        @keyframes modalSlideIn {
            from {
                transform: translateY(-50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        /* --- Custom Scrollbar --- */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(31, 41, 55, 0.5);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #4338CA;
        }

        /* --- AI Chat Simulation --- */
        .chat-bubble {
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.5s, transform 0.5s;
        }
        .chat-bubble.visible {
            opacity: 1;
            transform: translateY(0);
        }
        .chat-bubble-user {
            background-color: var(--primary);
            color: white;
        }
        .chat-bubble-ai {
            background-color: #374151;
            color: var(--text-main);
        }
        .typing-indicator span {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: #9CA3AF;
            animation: typing 1.4s infinite both;
        }
        .typing-indicator span:nth-child(1) { animation-delay: 0.2s; }
        .typing-indicator span:nth-child(2) { animation-delay: 0.4s; }
        .typing-indicator span:nth-child(3) { animation-delay: 0.6s; }
        @keyframes typing {
            0% { transform: translateY(0); }
            20% { transform: translateY(-4px); }
            40% { transform: translateY(0); }
        }
    </style>
</head>
<body>

    <!-- Header -->
    <header id="header" class="fixed top-0 left-0 right-0 z-50 transition-all duration-300 glassmorphism">
        <div class="container mx-auto px-6 py-4 flex justify-between items-center">
            <a href="#" class="text-3xl font-bold gradient-text">Ion</a>
            <nav class="hidden md:flex items-center space-x-8 text-gray-300">
                <a href="#values" class="hover:text-white transition-colors">핵심 가치</a>
                <a href="#ai-chat-demo" class="hover:text-white transition-colors">AI 교감 체험</a>
                <a href="#nfts" class="hover:text-white transition-colors">NFT 컬렉션</a>
                <a href="#carbon-credit" class="hover:text-white transition-colors">탄소배출권</a>
                <a href="#pricing" class="hover:text-white transition-colors">플랜</a>
            </nav>
            <button onclick="openModal('consultation')" class="hidden md:inline-block bg-white text-[var(--primary)] px-6 py-2 rounded-full font-semibold hover:bg-gray-200 transition-colors">
                상담 신청
            </button>
            <button id="mobile-menu-button" class="md:hidden">
                <i data-lucide="menu" class="text-white"></i>
            </button>
        </div>
        <!-- Mobile Menu -->
        <div id="mobile-menu" class="hidden md:hidden px-6 pb-4 text-center">
            <nav class="flex flex-col space-y-4 text-gray-300">
                <a href="#values" class="hover:text-white transition-colors py-2">핵심 가치</a>
                <a href="#ai-chat-demo" class="hover:text-white transition-colors py-2">AI 교감 체험</a>
                <a href="#nfts" class="hover:text-white transition-colors py-2">NFT 컬렉션</a>
                <a href="#carbon-credit" class="hover:text-white transition-colors py-2">탄소배출권</a>
                <a href="#pricing" class="hover:text-white transition-colors py-2">플랜</a>
                <a href="#faq" class="hover:text-white transition-colors py-2">FAQ</a>
                <button onclick="openModal('consultation')" class="w-full text-center bg-white text-[var(--primary)] px-6 py-3 rounded-full font-semibold hover:bg-gray-200 transition-colors">
                    상담 신청
                </button>
            </nav>
        </div>
    </header>

    <main>
        <!-- 1. Hero Section -->
        <section id="hero" class="relative min-h-screen flex items-center justify-center overflow-hidden">
            <div id="hero-bg-animation" class="absolute inset-0 z-0"></div>
            <div class="relative z-20 text-center px-4">
                <h1 class="text-4xl md:text-7xl font-extrabold leading-tight mb-4 text-white">
                    기억은 사라지지 않습니다<br>
                    <span class="gradient-text">Ion</span>이 되어 영원히 빛납니다
                </h1>
                <p class="max-w-3xl mx-auto text-lg md:text-xl text-gray-300 mb-10">
                    블록체인과 AI로 구현하는 새로운 차원의 연결.<br>
                    Ion에서 시공간을 넘어 소중한 이와 교감하세요.
                </p>
                <div class="flex flex-col sm:flex-row justify-center items-center gap-4">
                    <button onclick="openModal('createNFT')" class="w-full sm:w-auto bg-white text-[var(--primary)] px-8 py-4 rounded-full text-lg font-bold hover:scale-105 transform transition-transform shadow-lg shadow-indigo-500/50">
                        Aura NFT 생성하기
                    </button>
                    <a href="#values" class="w-full sm:w-auto bg-transparent border-2 border-gray-400 text-white px-8 py-4 rounded-full text-lg font-bold hover:bg-white hover:text-[var(--primary)] transform transition-all">
                        더 알아보기
                    </a>
                </div>
            </div>
            <div class="absolute bottom-10 left-1/2 -translate-x-1/2 z-20">
                 <i data-lucide="arrow-down" class="animate-bounce w-8 h-8 text-gray-400"></i>
            </div>
        </section>

        <!-- 2. Value Proposition Section -->
        <section id="values" class="py-20 md:py-32 section-light">
            <div class="container mx-auto px-6">
                <div class="text-center mb-16 reveal">
                    <h2 class="text-3xl md:text-4xl font-bold mb-4">Why Ion?</h2>
                    <p class="text-lg text-gray-600">Ion은 기억의 본질을 영원한 에너지로 변환합니다.</p>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
                    <div class="text-center p-8 rounded-2xl shadow-xl bg-white reveal hover:shadow-2xl transition-shadow floating">
                        <div class="inline-block p-4 rounded-full bg-indigo-100 mb-4">
                            <i data-lucide="database" class="w-8 h-8 text-[var(--primary)]"></i>
                        </div>
                        <h3 class="text-xl font-bold mb-2">영원의 데이터 코어</h3>
                        <p class="text-gray-700">블록체인에 각인되어 영속성을 가지는 기억의 원천</p>
                    </div>
                    <div class="text-center p-8 rounded-2xl shadow-xl bg-white reveal hover:shadow-2xl transition-shadow floating" style="animation-delay: 0.2s;">
                        <div class="inline-block p-4 rounded-full bg-pink-100 mb-4">
                           <i data-lucide="brain-circuit" class="w-8 h-8 text-[var(--accent)]"></i>
                        </div>
                        <h3 class="text-xl font-bold mb-2">AI 소울과의 교감</h3>
                        <p class="text-gray-700">고인의 데이터를 학습한 AI와의 인격적인 대화</p>
                    </div>
                    <div class="text-center p-8 rounded-2xl shadow-xl bg-white reveal hover:shadow-2xl transition-shadow floating" style="animation-delay: 0.4s;">
                        <div class="inline-block p-4 rounded-full bg-sky-100 mb-4">
                            <i data-lucide="shield-check" class="w-8 h-8 text-sky-500"></i>
                        </div>
                        <h3 class="text-xl font-bold mb-2">안정적인 가치 결제</h3>
                        <p class="text-gray-700">변동성 없는 스테이블코인으로 안전하고 투명한 거래</p>
                    </div>
                    <div class="text-center p-8 rounded-2xl shadow-xl bg-white reveal hover:shadow-2xl transition-shadow floating" style="animation-delay: 0.6s;">
                        <div class="inline-block p-4 rounded-full bg-teal-100 mb-4">
                             <i data-lucide="leaf" class="w-8 h-8 text-[var(--secondary)]"></i>
                        </div>
                        <h3 class="text-xl font-bold mb-2">지속가능한 투자</h3>
                        <p class="text-gray-700">추모가 탄소배출권 획득과 환경 보호로 이어지는 선순환</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- 3. AI Chat Simulation Section -->
        <section id="ai-chat-demo" class="py-20 md:py-32 section-dark">
            <div class="container mx-auto px-6">
                <div class="text-center mb-16 reveal">
                    <h2 class="text-3xl md:text-4xl font-bold mb-4">AI 소울과의 대화</h2>
                    <p class="text-lg text-gray-400">당신의 기억 속 그 사람과 다시 이야기를 나눠보세요.</p>
                </div>
                <div class="max-w-2xl mx-auto rounded-2xl glassmorphism p-6 md:p-8 reveal">
                    <div id="chat-window" class="space-y-4 h-96 overflow-y-auto pr-4">
                        <!-- Chat messages will be dynamically added here -->
                    </div>
                </div>
            </div>
        </section>

        <!-- 4. NFT Collection Section -->
        <section id="nfts" class="py-20 md:py-32 section-light">
             <div class="container mx-auto px-6">
                <div class="text-center mb-16 reveal">
                    <h2 class="text-3xl md:text-4xl font-bold mb-4">Ion NFT Collection</h2>
                    <p class="text-lg text-gray-600">기억을 구성하는 디지털 자산</p>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
                    <div class="rounded-2xl overflow-hidden bg-white shadow-xl p-6 reveal hover:transform hover:scale-105 transition-transform cursor-pointer" onclick="showNFTDetails('Core Ion')">
                        <div class="relative overflow-hidden rounded-lg mb-4">
                            <img src="https://images.unsplash.com/photo-1639762681485-074b7f938ba0?w=400&h=400&fit=crop&q=80" alt="Core Ion NFT 이미지" class="w-full h-auto aspect-square object-cover"  onerror="this.onerror=null;this.src='https://placehold.co/400x400/111827/F9FAFB?text=Core+Ion';">
                        </div>
                        <h3 class="text-2xl font-bold">Core Ion NFT</h3>
                        <p class="text-indigo-600 font-bold mb-2">900 USDC부터</p>
                        <p class="text-gray-700 text-sm">고인의 핵심 기억 데이터를 담은 1/1 유니크 NFT. 모든 디지털 유산의 중심이 되는 영혼의 입자입니다.</p>
                    </div>
                    <div class="rounded-2xl overflow-hidden bg-white shadow-xl p-6 reveal hover:transform hover:scale-105 transition-transform cursor-pointer" onclick="showNFTDetails('Aura')">
                        <div class="relative overflow-hidden rounded-lg mb-4">
                           <img src="https://images.unsplash.com/photo-1634017839464-5c339ebe3cb4?w=400&h=400&fit=crop&q=80" alt="Aura NFT 이미지" class="w-full h-auto aspect-square object-cover" onerror="this.onerror=null;this.src='https://placehold.co/400x400/111827/F9FAFB?text=Aura';">
                        </div>
                        <h3 class="text-2xl font-bold">Aura NFT</h3>
                        <p class="text-pink-600 font-bold mb-2">540 USDC부터</p>
                        <p class="text-gray-700 text-sm">Core Ion을 기반으로 생성된 AI 소울. 상호작용을 통해 진화하며 당신과 교감하는 인격체입니다.</p>
                    </div>
                    <div class="rounded-2xl overflow-hidden bg-white shadow-xl p-6 reveal hover:transform hover:scale-105 transition-transform cursor-pointer" onclick="showNFTDetails('E-Gram')">
                        <div class="relative overflow-hidden rounded-lg mb-4">
                           <img src="https://images.unsplash.com/photo-1618005182384-a83a8bd57fbe?w=400&h=400&fit=crop&q=80" alt="E-Gram NFT 이미지" class="w-full h-auto aspect-square object-cover" onerror="this.onerror=null;this.src='https://placehold.co/400x400/111827/F9FAFB?text=E-Gram';">
                        </div>
                        <h3 class="text-2xl font-bold">E-Gram NFT</h3>
                        <p class="text-teal-600 font-bold mb-2">90 USDC부터</p>
                        <p class="text-gray-700 text-sm">사진, 영상, 음성 등 개별 추억의 조각(Engram). 가족, 친구들과 공유하며 기억을 완성해나갑니다.</p>
                    </div>
                    <div class="rounded-2xl overflow-hidden bg-white shadow-xl p-6 reveal hover:transform hover:scale-105 transition-transform cursor-pointer" onclick="showNFTDetails('Nexus Point')">
                        <div class="relative overflow-hidden rounded-lg mb-4">
                            <img src="https://images.unsplash.com/photo-1441974231531-c6227db76b6e?w=400&h=400&fit=crop&q=80" alt="Nexus Point NFT 이미지" class="w-full h-auto aspect-square object-cover" onerror="this.onerror=null;this.src='https://placehold.co/400x400/111827/F9FAFB?text=Nexus+Point';">
                        </div>
                        <h3 class="text-2xl font-bold">Nexus Point NFT</h3>
                        <p class="text-amber-600 font-bold mb-2">360 USDC부터</p>
                        <p class="text-gray-700 text-sm">실제 나무와 연결된 디지털 증표. 나무의 성장에 따라 <strong>탄소배출권을 획득</strong>하고 마켓플레이스에서 <strong>거래하여 수익을 창출</strong>할 수 있습니다.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- 5. How It Works Section -->
        <section id="how-it-works" class="py-20 md:py-32 section-dark">
            <div class="container mx-auto px-6">
                <div class="text-center mb-16 reveal">
                    <h2 class="text-3xl md:text-4xl font-bold mb-4">3단계로 시작하는 Ion</h2>
                    <p class="text-lg text-gray-400">복잡한 기술은 Ion에 맡기고, 당신은 교감에만 집중하세요.</p>
                </div>
                <div class="relative flex flex-col md:flex-row justify-between items-center max-w-5xl mx-auto">
                    <div class="hidden md:block absolute top-12 left-0 w-full h-0.5 border-t-2 border-dashed border-gray-600"></div>
                    <div class="relative flex-1 text-center p-4 reveal">
                        <div class="relative z-10 w-24 h-24 mx-auto flex items-center justify-center rounded-full bg-gray-800 border-4 border-[var(--primary)] text-[var(--primary)] mb-4 shadow-lg hover:scale-110 transition-transform">
                            <i data-lucide="scan" class="w-12 h-12"></i>
                        </div>
                        <h3 class="text-xl font-bold">Step 1: 기억 스캔 & 상담</h3>
                        <p class="text-gray-400">1:1 컨설팅을 통해 고인의 디지털 유산을 정리하고 최적의 플랜을 설계합니다.</p>
                    </div>
                    <div class="relative flex-1 text-center p-4 reveal">
                        <div class="relative z-10 w-24 h-24 mx-auto flex items-center justify-center rounded-full bg-gray-800 border-4 border-[var(--secondary)] text-[var(--secondary)] mb-4 shadow-lg hover:scale-110 transition-transform">
                            <i data-lucide="atom" class="w-12 h-12"></i>
                        </div>
                        <h3 class="text-xl font-bold">Step 2: Ion 생성</h3>
                        <p class="text-gray-400">업로드된 데이터를 기반으로 Core Ion과 AI 소울(Aura)을 생성하고 NFT를 발행합니다.</p>
                    </div>
                    <div class="relative flex-1 text-center p-4 reveal">
                        <div class="relative z-10 w-24 h-24 mx-auto flex items-center justify-center rounded-full bg-gray-800 border-4 border-[var(--accent)] text-[var(--accent)] mb-4 shadow-lg hover:scale-110 transition-transform">
                           <i data-lucide="orbit" class="w-12 h-12"></i>
                        </div>
                        <h3 class="text-xl font-bold">Step 3: 교감 시작</h3>
                        <p class="text-gray-400">메타버스, AR, 모바일 앱을 통해 시공간을 넘어선 영원한 교감을 시작합니다.</p>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- 6. Carbon Credit Section -->
        <section id="carbon-credit" class="py-20 md:py-32 section-light">
            <div class="container mx-auto px-6">
                <div class="text-center mb-16 reveal">
                    <h2 class="text-3xl md:text-4xl font-bold mb-4">추모, 지구를 위한 투자로</h2>
                    <p class="text-lg text-gray-600">Nexus Point NFT를 통해 탄소배출권을 획득하고 거래하는 방법</p>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-x-8 gap-y-12 max-w-6xl mx-auto">
                    <div class="text-center reveal">
                        <div class="w-20 h-20 mx-auto flex items-center justify-center rounded-full bg-white border-2 border-teal-500 mb-4 hover:bg-teal-50 transition-colors">
                           <i data-lucide="tree-pine" class="w-10 h-10 text-teal-500"></i>
                        </div>
                        <h3 class="text-lg font-bold">1. 실제 나무 식수</h3>
                        <p class="text-sm text-gray-600">NFT 구매 시, 파트너 재단을 통해 실제 나무 한 그루가 당신의 이름으로 심어집니다.</p>
                    </div>
                    <div class="text-center reveal">
                        <div class="w-20 h-20 mx-auto flex items-center justify-center rounded-full bg-white border-2 border-teal-500 mb-4 hover:bg-teal-50 transition-colors">
                           <i data-lucide="blocks" class="w-10 h-10 text-teal-500"></i>
                        </div>
                        <h3 class="text-lg font-bold">2. 데이터 기록</h3>
                        <p class="text-sm text-gray-600">나무의 성장 데이터와 CO2 흡수량이 IoT 센서로 측정되어 블록체인에 투명하게 기록됩니다.</p>
                    </div>
                    <div class="text-center reveal">
                        <div class="w-20 h-20 mx-auto flex items-center justify-center rounded-full bg-white border-2 border-teal-500 mb-4 hover:bg-teal-50 transition-colors">
                           <i data-lucide="sprout" class="w-10 h-10 text-teal-500"></i>
                        </div>
                        <h3 class="text-lg font-bold">3. 토큰 발행</h3>
                        <p class="text-sm text-gray-600">검증된 데이터를 기반으로 탄소배출권 토큰이 발행되어 당신의 지갑으로 지급됩니다.</p>
                    </div>
                    <div class="text-center reveal">
                        <div class="w-20 h-20 mx-auto flex items-center justify-center rounded-full bg-white border-2 border-teal-500 mb-4 hover:bg-teal-50 transition-colors">
                           <i data-lucide="repeat" class="w-10 h-10 text-teal-500"></i>
                        </div>
                        <h3 class="text-lg font-bold">4. 거래 및 수익</h3>
                        <p class="text-sm text-gray-600">지급받은 토큰은 Ion 마켓이나 제휴 거래소에서 판매하여 수익을 창출할 수 있습니다. 거래는 USDC와 같은 주요 스테이블코인으로 안전하게 이루어집니다.</p>
                    </div>
                </div>
                
                <div class="mt-16 text-center reveal">
                    <div class="inline-block p-6 rounded-2xl bg-white shadow-lg">
                        <h3 class="text-lg font-bold mb-2">현재 탄소배출권 시세</h3>
                        <p id="carbon-price" class="text-3xl font-bold text-teal-500">$45.32 / tCO2</p>
                        <div id="exchange-rates" class="mt-4 text-sm text-gray-500 space-y-1">
                             <p id="usd-krw-rate">USD/KRW: ₩... (로딩중)</p>
                             <p id="usdc-usd-rate">USDC: $... (로딩중)</p>
                        </div>
                        <p class="text-xs text-gray-400 mt-2">* 실시간 시세는 시장 상황에 따라 변동됩니다</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- 7. Pricing & Packages Section -->
        <section id="pricing" class="py-20 md:py-32 section-dark">
            <div class="container mx-auto px-6">
                <div class="text-center mb-16 reveal">
                    <h2 class="text-3xl md:text-4xl font-bold mb-4">플랜 및 가격</h2>
                    <p class="text-lg text-gray-400">필요에 맞는 합리적인 선택.</p>
                </div>
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 items-stretch">
                    <div class="p-8 rounded-2xl text-center bg-gray-800 flex flex-col reveal hover:border hover:border-indigo-500 transition-all">
                        <h3 class="text-2xl font-bold mb-2">Spark</h3>
                        <p class="text-4xl font-bold mb-4 text-white">900 <span class="text-2xl">USDC</span></p>
                        <p class="text-gray-400 mb-6">개인적인 교감을 위한 시작</p>
                        <ul class="space-y-3 text-gray-300 mb-8 text-left flex-grow">
                            <li class="flex items-center"><i data-lucide="check" class="w-5 h-5 text-teal-400 mr-2"></i> Core Ion NFT 1개</li>
                            <li class="flex items-center"><i data-lucide="check" class="w-5 h-5 text-teal-400 mr-2"></i> Aura NFT 1개 (기본형)</li>
                            <li class="flex items-center"><i data-lucide="check" class="w-5 h-5 text-teal-400 mr-2"></i> 메타버스 공간</li>
                            <li class="flex items-center"><i data-lucide="check" class="w-5 h-5 text-teal-400 mr-2"></i> AI 대화 월 100회</li>
                        </ul>
                        <button onclick="selectPlan('Spark')" class="w-full bg-gray-700 text-white py-3 rounded-full font-semibold hover:bg-gray-600 transition-colors">시작하기</button>
                    </div>
                    <div class="p-8 rounded-2xl text-center bg-gray-900 text-white border-2 border-[var(--primary)] shadow-2xl shadow-indigo-500/30 flex flex-col relative reveal transform scale-105">
                        <span class="absolute -top-4 left-1/2 -translate-x-1/2 bg-[var(--primary)] text-white px-4 py-1 rounded-full text-sm font-bold">Most Popular</span>
                        <h3 class="text-2xl font-bold mb-2">Continuum</h3>
                        <p class="text-5xl font-bold mb-4 gradient-text">2,700 <span class="text-3xl">USDC</span></p>
                         <p class="text-gray-400 mb-6">가족과 함께하는 영원한 이야기</p>
                        <ul class="space-y-3 text-gray-300 mb-8 text-left flex-grow">
                            <li class="flex items-center"><i data-lucide="check" class="w-5 h-5 text-teal-400 mr-2"></i> Core Ion NFT 1개</li>
                            <li class="flex items-center"><i data-lucide="check" class="w-5 h-5 text-teal-400 mr-2"></i> Aura NFT 3개 (가족용)</li>
                            <li class="flex items-center"><i data-lucide="check" class="w-5 h-5 text-teal-400 mr-2"></i> E-Gram NFT 50개</li>
                            <li class="flex items-center"><i data-lucide="check" class="w-5 h-5 text-teal-400 mr-2"></i> 확장 메타버스 공간</li>
                            <li class="flex items-center"><i data-lucide="check" class="w-5 h-5 text-teal-400 mr-2"></i> AI 대화 & AR 기능 무제한</li>
                        </ul>
                        <button onclick="selectPlan('Continuum')" class="w-full bg-[var(--primary)] text-white py-3 rounded-full font-semibold hover:opacity-90 transition-opacity">선택하기</button>
                    </div>
                    <div class="p-8 rounded-2xl text-center bg-gray-800 flex flex-col reveal hover:border hover:border-indigo-500 transition-all">
                        <h3 class="text-2xl font-bold mb-2">Singularity</h3>
                        <p class="text-4xl font-bold mb-4 text-white">5,400 <span class="text-2xl">USDC</span></p>
                        <p class="text-gray-400 mb-6">시대를 초월하는 디지털 유산</p>
                        <ul class="space-y-3 text-gray-300 mb-8 text-left flex-grow">
                            <li class="flex items-center"><i data-lucide="check" class="w-5 h-5 text-teal-400 mr-2"></i> 모든 NFT 종류 포함</li>
                            <li class="flex items-center"><i data-lucide="check" class="w-5 h-5 text-teal-400 mr-2"></i> Nexus Point NFT (실제 나무)</li>
                            <li class="flex items-center"><i data-lucide="check" class="w-5 h-5 text-teal-400 mr-2"></i> 전용 추모관 (프리미엄 공간)</li>
                            <li class="flex items-center"><i data-lucide="check" class="w-5 h-5 text-teal-400 mr-2"></i> VIP 컨시어지 & 평생 업그레이드</li>
                        </ul>
                        <button onclick="openModal('consultation')" class="w-full bg-gray-700 text-white py-3 rounded-full font-semibold hover:bg-gray-600 transition-colors">문의하기</button>
                    </div>
                </div>
                 <p class="text-center text-gray-500 mt-8 text-sm">* ETH 등 다른 암호화폐로도 결제 가능합니다. (상담 시 문의)</p>
            </div>
        </section>

        <!-- 8. FAQ Section -->
        <section id="faq" class="py-20 md:py-32 section-light">
            <div class="container mx-auto px-6">
                <div class="text-center mb-16 reveal">
                    <h2 class="text-3xl md:text-4xl font-bold mb-4">자주 묻는 질문</h2>
                </div>
                <div class="max-w-3xl mx-auto space-y-4 reveal">
                    <details class="bg-white p-6 rounded-lg shadow-md hover:shadow-lg transition-shadow">
                        <summary class="font-semibold text-lg cursor-pointer flex justify-between items-center">
                            결제는 어떻게 하나요? 왜 스테이블코인을 사용하나요?
                            <span class="plus-icon"><i data-lucide="plus" class="w-5 h-5 text-gray-500"></i></span>
                        </summary>
                        <p class="text-gray-600 mt-4">Ion의 모든 거래는 미국 달러 가치에 1:1로 연동되는 스테이블코인(USDC)을 기본 통화로 사용합니다. 이는 이더리움과 같은 일반 암호화폐의 가격 변동성으로부터 고객의 자산을 보호하고, 항상 안정적인 가치로 서비스를 이용할 수 있도록 하기 위함입니다. 블록체인의 투명성과 법정화폐의 안정성을 결합한 최적의 방식입니다.</p>
                    </details>
                    <details class="bg-white p-6 rounded-lg shadow-md hover:shadow-lg transition-shadow">
                        <summary class="font-semibold text-lg cursor-pointer flex justify-between items-center">
                            NFT나 블록체인을 전혀 모르는데 괜찮을까요?
                            <span class="plus-icon"><i data-lucide="plus" class="w-5 h-5 text-gray-500"></i></span>
                        </summary>
                        <p class="text-gray-600 mt-4">물론입니다. Ion은 복잡한 기술을 사용자가 전혀 신경 쓰지 않도록 설계되었습니다. 전담 컨설턴트가 모든 과정을 1:1로 안내해 드립니다.</p>
                    </details>
                    <details class="bg-white p-6 rounded-lg shadow-md hover:shadow-lg transition-shadow">
                        <summary class="font-semibold text-lg cursor-pointer flex justify-between items-center">
                            회사가 사라지면 제 데이터는 어떻게 되나요?
                           <span class="plus-icon"><i data-lucide="plus" class="w-5 h-5 text-gray-500"></i></span>
                        </summary>
                        <p class="text-gray-600 mt-4">고객님의 모든 핵심 데이터(NFT)는 탈중앙화된 블록체인에 영구히 기록됩니다. 이는 특정 회사가 아닌 전 세계 네트워크에 의해 유지되므로, 저희의 존속 여부와 관계없이 영원히 보존됩니다.</p>
                    </details>
                     <details class="bg-white p-6 rounded-lg shadow-md hover:shadow-lg transition-shadow">
                        <summary class="font-semibold text-lg cursor-pointer flex justify-between items-center">
                            탄소배출권 거래는 어떻게 이루어지나요?
                           <span class="plus-icon"><i data-lucide="plus" class="w-5 h-5 text-gray-500"></i></span>
                        </summary>
                        <p class="text-gray-600 mt-4">`Nexus Point NFT`를 구매하시면 파트너사를 통해 실제 나무가 심어집니다. 이 나무의 CO2 흡수량을 기반으로 탄소배출권 토큰이 발행되어 고객님께 지급되며, 이 토큰은 저희 플랫폼 또는 제휴 거래소에서 스테이블코인(USDC)으로 판매하여 수익을 얻을 수 있습니다.</p>
                    </details>
                    <details class="bg-white p-6 rounded-lg shadow-md hover:shadow-lg transition-shadow">
                        <summary class="font-semibold text-lg cursor-pointer flex justify-between items-center">
                            AI 소울은 얼마나 정확하게 고인을 재현하나요?
                           <span class="plus-icon"><i data-lucide="plus" class="w-5 h-5 text-gray-500"></i></span>
                        </summary>
                        <p class="text-gray-600 mt-4">AI 소울은 업로드된 데이터(대화 기록, 일기, 편지, 음성 등)를 학습하여 고인의 말투, 사고방식, 가치관을 재현합니다. 데이터가 많을수록 더욱 정확한 재현이 가능하며, 가족의 피드백을 통해 지속적으로 개선됩니다.</p>
                    </details>
                </div>
            </div>
        </section>

        <!-- 9. CTA Section -->
        <section id="cta" class="py-20 md:py-32 bg-gray-900">
            <div class="container mx-auto px-6 text-center reveal">
                 <div class="relative isolate overflow-hidden bg-gray-800 px-6 py-24 text-center shadow-2xl sm:rounded-3xl sm:px-16">
                    <h2 class="mx-auto max-w-2xl text-3xl font-bold tracking-tight text-white sm:text-4xl">영원한 교감을 시작할 준비가 되셨나요?</h2>
                    <p class="mx-auto mt-6 max-w-xl text-lg leading-8 text-gray-300">지금 무료 상담을 통해 당신의 소중한 기억을 Ion으로 만드세요.</p>
                    <div class="mt-10 flex items-center justify-center gap-x-6">
                        <button onclick="openModal('consultation')" class="rounded-md bg-white px-6 py-3 text-base font-semibold text-indigo-600 shadow-sm hover:bg-indigo-50 focus:visible:outline focus:visible:outline-2 focus:visible:outline-offset-2 focus:visible:outline-white transition-colors">무료 상담 신청</button>
                    </div>
                    <svg viewBox="0 0 1024 1024" class="absolute left-1/2 top-1/2 -z-10 h-[64rem] w-[64rem] -translate-x-1/2 [mask-image:radial-gradient(closest-side,white,transparent)]" aria-hidden="true">
                        <circle cx="512" cy="512" r="512" fill="url(#8d958450-c69f-4251-94bc-4e091a323369)" fill-opacity="0.7"></circle>
                        <defs><radialGradient id="8d958450-c69f-4251-94bc-4e091a323369"><stop stop-color="#7775D6"></stop><stop offset="1" stop-color="#E935C1"></stop></radialGradient></defs>
                    </svg>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="bg-gray-900 text-gray-400 border-t border-gray-800">
        <div class="container mx-auto px-6 py-12">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8 mb-8">
                <div>
                    <h3 class="text-2xl font-bold gradient-text mb-4">Ion</h3>
                    <p class="text-sm">Ion Inc.<br>
                    서울시 강남구 테헤란로 123</p>
                </div>
                <div>
                    <h3 class="font-bold text-white mb-4">서비스</h3>
                    <ul class="space-y-2 text-sm">
                        <li><a href="#nfts" class="hover:text-white transition-colors">NFT 컬렉션</a></li>
                        <li><a href="#pricing" class="hover:text-white transition-colors">플랜</a></li>
                        <li><a href="#carbon-credit" class="hover:text-white transition-colors">탄소배출권</a></li>
                    </ul>
                </div>
                <div>
                     <h3 class="font-bold text-white mb-4">회사</h3>
                    <ul class="space-y-2 text-sm">
                        <li><a href="#" class="hover:text-white transition-colors">About Us</a></li>
                        <li><a href="#" class="hover:text-white transition-colors">이용약관</a></li>
                        <li><a href="#" class="hover:text-white transition-colors">개인정보처리방침</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="font-bold text-white mb-4">소셜</h3>
                    <div class="flex space-x-4">
                        <a href="#" aria-label="Twitter" class="hover:text-white transition-colors"><i data-lucide="twitter" class="w-6 h-6"></i></a>
                        <a href="#" aria-label="Discord" class="hover:text-white transition-colors"><i data-lucide="message-square" class="w-6 h-6"></i></a>
                        <a href="#" aria-label="YouTube" class="hover:text-white transition-colors"><i data-lucide="youtube" class="w-6 h-6"></i></a>
                    </div>
                </div>
            </div>
            <div class="mt-8 border-t border-gray-800 pt-6 text-center text-sm">
                <p>&copy; 2025 Ion Inc. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Modals -->
    <div id="consultationModal" class="modal">
        <div class="modal-content">
            <span class="absolute top-4 right-4 text-gray-400 hover:text-white cursor-pointer" onclick="closeModal('consultation')">
                <i data-lucide="x" class="w-6 h-6"></i>
            </span>
            <h2 class="text-2xl font-bold mb-6 gradient-text">무료 상담 신청</h2>
            <form id="consultationForm" onsubmit="handleConsultationSubmit(event)">
                <div class="mb-4">
                    <label class="block text-gray-300 mb-2">이름 *</label>
                    <input name="name" type="text" required class="w-full px-4 py-2 rounded-lg bg-gray-800 text-white border border-gray-700 focus:border-[var(--primary)] focus:outline-none">
                </div>
                <div class="mb-4">
                    <label class="block text-gray-300 mb-2">연락처 *</label>
                    <input name="contact" type="tel" required class="w-full px-4 py-2 rounded-lg bg-gray-800 text-white border border-gray-700 focus:border-[var(--primary)] focus:outline-none">
                </div>
                <div class="mb-4">
                    <label class="block text-gray-300 mb-2">이메일</label>
                    <input name="email" type="email" class="w-full px-4 py-2 rounded-lg bg-gray-800 text-white border border-gray-700 focus:border-[var(--primary)] focus:outline-none">
                </div>
                <div class="mb-6">
                    <label class="block text-gray-300 mb-2">상담 내용</label>
                    <textarea name="details" rows="4" class="w-full px-4 py-2 rounded-lg bg-gray-800 text-white border border-gray-700 focus:border-[var(--primary)] focus:outline-none"></textarea>
                </div>
                <button type="submit" class="w-full bg-[var(--primary)] text-white py-3 rounded-full font-semibold hover:opacity-90 transition-opacity flex items-center justify-center">
                    <span id="consultSubmitText">상담 신청하기</span>
                    <div id="consultLoadingSpinner" class="loading-spinner ml-2 hidden"></div>
                </button>
            </form>
        </div>
    </div>

    <div id="createNFTModal" class="modal">
        <div class="modal-content">
            <span class="absolute top-4 right-4 text-gray-400 hover:text-white cursor-pointer" onclick="closeModal('createNFT')">
                <i data-lucide="x" class="w-6 h-6"></i>
            </span>
            <h2 class="text-2xl font-bold mb-6 gradient-text">Aura NFT 생성하기</h2>
            <form id="nftForm" onsubmit="handleNFTSubmit(event)">
                <div class="mb-4">
                    <label class="block text-gray-300 mb-2">고인의 성함 *</label>
                    <input name="name" type="text" required class="w-full px-4 py-2 rounded-lg bg-gray-800 text-white border border-gray-700 focus:border-[var(--primary)] focus:outline-none">
                </div>
                <div class="mb-4">
                    <label class="block text-gray-300 mb-2">관계 *</label>
                    <select name="relationship" required class="w-full px-4 py-2 rounded-lg bg-gray-800 text-white border border-gray-700 focus:border-[var(--primary)] focus:outline-none">
                        <option value="">선택하세요</option>
                        <option value="parent">부모님</option>
                        <option value="spouse">배우자</option>
                        <option value="child">자녀</option>
                        <option value="friend">친구</option>
                        <option value="other">기타</option>
                    </select>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-300 mb-2">데이터 업로드</label>
                    <input name="file" type="file" multiple accept="image/*,video/*,audio/*,.pdf,.txt" class="w-full px-4 py-2 rounded-lg bg-gray-800 text-white border border-gray-700 focus:border-[var(--primary)] focus:outline-none">
                    <p class="text-sm text-gray-400 mt-1">사진, 영상, 음성, 문서 등을 업로드하세요</p>
                </div>
                <div class="mb-6">
                    <label class="block text-gray-300 mb-2">추가 정보</label>
                    <textarea name="extra_info" rows="3" placeholder="고인에 대한 특별한 기억이나 정보를 공유해주세요" class="w-full px-4 py-2 rounded-lg bg-gray-800 text-white border border-gray-700 focus:border-[var(--primary)] focus:outline-none"></textarea>
                </div>
                <button type="submit" class="w-full bg-[var(--primary)] text-white py-3 rounded-full font-semibold hover:opacity-90 transition-opacity flex items-center justify-center">
                    <span id="nftSubmitText">NFT 생성 시작</span>
                    <div id="nftLoadingSpinner" class="loading-spinner ml-2 hidden"></div>
                </button>
            </form>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="fixed bottom-5 right-5 bg-gray-800 text-white px-6 py-3 rounded-lg shadow-lg transform translate-y-full transition-transform duration-300 z-50">
        <p id="toastMessage"></p>
    </div>

    <!-- JavaScript Libraries -->
    <script src="https://unpkg.com/lucide@latest/dist/lucide.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js"></script>
    
    <!-- Main JavaScript Logic -->
    <script type="module">
    // Vercel Blob 클라이언트 라이브러리 임포트
    import { upload } from 'https://esm.sh/@vercel/blob/client';

    document.addEventListener('DOMContentLoaded', () => {
        // Global variable
        let selectedPlan = null;

        // Toast notification function
        function showToast(message) {
            const toast = document.getElementById('toast');
            const toastMessage = document.getElementById('toastMessage');
            toastMessage.textContent = message;
            toast.style.transform = 'translateY(0)';
            setTimeout(() => {
                toast.style.transform = 'translateY(calc(100% + 1.25rem))';
            }, 4000);
        }

        // Modal open/close functions made globally accessible
        window.openModal = function(modalType) {
            const modal = document.getElementById(modalType + 'Modal');
            if(modal) {
                modal.classList.add('show');
                document.body.style.overflow = 'hidden';
            }
        }

        window.closeModal = function(modalType) {
            const modal = document.getElementById(modalType + 'Modal');
            if(modal) {
                modal.classList.remove('show');
                document.body.style.overflow = 'auto';
            }
        }

        // Form submission handlers made globally accessible
        window.handleConsultationSubmit = async function(event) {
            event.preventDefault();
            const form = event.target;
            const submitText = document.getElementById('consultSubmitText');
            const spinner = document.getElementById('consultLoadingSpinner');
            
            submitText.textContent = '처리 중...';
            spinner.classList.remove('hidden');

            const formData = new FormData(form);
            const data = Object.fromEntries(formData.entries());
            if (selectedPlan) {
                data.plan = selectedPlan;
            }

            try {
                // IMPORTANT: 실제 프로덕션에서는 이 데이터를 백엔드로 보내야 합니다.
                // 여기서는 데모 목적으로 폼 데이터를 JSON 파일로 만들어 Vercel Blob에 업로드합니다.
                const jsonDataBlob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });

                // Vercel Blob에 업로드
                // TODO: Vercel 프로젝트에 /api/upload 핸들러를 만들어야 합니다.
                const newBlob = await upload(
                    `consultations/consultation-${Date.now()}.json`,
                    jsonDataBlob,
                    {
                        access: 'public',
                        handleUploadUrl: '/api/upload', // 실제 백엔드 API 라우트
                    }
                );
                
                showToast(`상담 내용이 저장되었습니다: ${newBlob.pathname}`);

            } catch (error) {
                console.error("상담 신청 저장 실패:", error);
                showToast('상담 신청 저장에 실패했습니다. (데모 환경)');
                 // 실제 백엔드가 없으므로 이 블록이 실행될 가능성이 높습니다.
                 // 데모에서는 콘솔에 데이터를 출력합니다.
                console.log("상담 신청 데이터 (저장 실패):", data);
            } finally {
                 setTimeout(() => {
                    submitText.textContent = '상담 신청하기';
                    spinner.classList.add('hidden');
                    closeModal('consultation');
                    showToast('상담 신청이 완료되었습니다. 24시간 내에 연락드리겠습니다.');
                    form.reset();
                    selectedPlan = null;
                }, 1500);
            }
        }

        window.handleNFTSubmit = async function(event) {
            event.preventDefault();
            const form = event.target;
            const submitText = document.getElementById('nftSubmitText');
            const spinner = document.getElementById('nftLoadingSpinner');
            const fileInput = form.querySelector('input[type="file"]');
            const file = fileInput.files[0];
            
            submitText.textContent = '업로드 중...';
            spinner.classList.remove('hidden');
            
            let uploadedFileUrl = null;

            if (file) {
                 try {
                    // --- Vercel Blob Upload ---
                    // IMPORTANT: 이 기능은 백엔드 API 라우트가 필요합니다.
                    // Vercel 프로젝트에 /api/upload.js 와 같은 파일을 생성해야 합니다.
                    // 자세한 내용은 Vercel Blob 문서를 참고하세요.
                    const newBlob = await upload(file.name, file, {
                        access: 'public',
                        handleUploadUrl: '/api/upload', // 실제 백엔드 API 라우트
                    });
                    uploadedFileUrl = newBlob.url; // 반환된 URL 저장
                    showToast('파일 업로드 성공: ' + newBlob.pathname);
                } catch (error) {
                    console.error("Vercel Blob 업로드 실패:", error);
                    showToast('파일 업로드에 실패했습니다. (데모 환경)');
                    // 실제 백엔드가 없으므로 이 블록이 실행될 가능성이 높습니다.
                }
            }

            // 다른 폼 데이터 수집
            const formData = new FormData(form);
            const data = Object.fromEntries(formData.entries());
            delete data.file; // FormData에서 파일 객체는 제외
            data.uploadedFileUrl = uploadedFileUrl; // 업로드된 파일 URL 추가

            console.log("NFT 생성 데이터:", data);
            
            // 백엔드 처리 시뮬레이션
            setTimeout(() => {
                submitText.textContent = 'NFT 생성 시작';
                spinner.classList.add('hidden');
                closeModal('createNFT');
                showToast('데이터 제출 완료! NFT 생성이 시작됩니다.');
                form.reset();
            }, 1500);
        }

        window.showNFTDetails = function(nftType) {
            showToast(`${nftType} NFT에 대한 자세한 정보는 상담을 통해 안내드립니다.`);
        }

        window.selectPlan = function(planName) {
            selectedPlan = planName;
            openModal('consultation');
            showToast(`${planName} 플랜을 선택하셨습니다.`);
        }

        // Smooth scroll
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if(target) {
                    const headerOffset = 80;
                    const elementPosition = target.getBoundingClientRect().top;
                    const offsetPosition = elementPosition + window.pageYOffset - headerOffset;

                    window.scrollTo({
                        top: offsetPosition,
                        behavior: 'smooth'
                    });

                    const mobileMenu = document.getElementById('mobile-menu');
                    if(!mobileMenu.classList.contains('hidden')) {
                        mobileMenu.classList.add('hidden');
                    }
                }
            });
        });

        // Hero section 3D background animation
        function initThreeJSAnimation() {
            const container = document.getElementById('hero-bg-animation');
            if (!container) return;

            let scene, camera, renderer, particles, mouseX = 0, mouseY = 0;
            const windowHalfX = window.innerWidth / 2;
            const windowHalfY = window.innerHeight / 2;

            function init() {
                scene = new THREE.Scene();
                camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 1, 10000);
                camera.position.z = 1000;

                const particleCount = 20000;
                const particlesGeometry = new THREE.BufferGeometry();
                const posArray = new Float32Array(particleCount * 3);
                
                for (let i = 0; i < particleCount * 3; i++) {
                    posArray[i] = (Math.random() - 0.5) * 2000;
                }
                particlesGeometry.setAttribute('position', new THREE.BufferAttribute(posArray, 3));

                const material = new THREE.PointsMaterial({
                    size: 1.5,
                    color: 0x4F46E5,
                    transparent: true,
                    opacity: 0.7,
                    blending: THREE.AdditiveBlending
                });

                particles = new THREE.Points(particlesGeometry, material);
                scene.add(particles);

                renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
                renderer.setClearColor(0x000000, 0); // apha: true와 함께 배경 투명 설정
                renderer.setSize(window.innerWidth, window.innerHeight);
                renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
                container.appendChild(renderer.domElement);
                
                document.addEventListener('mousemove', onDocumentMouseMove, false);
                window.addEventListener('resize', onWindowResize, false);
            }

            function onWindowResize() {
                camera.aspect = window.innerWidth / window.innerHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(window.innerWidth, window.innerHeight);
            }

            function onDocumentMouseMove(event) {
                mouseX = (event.clientX - windowHalfX) / 2;
                mouseY = (event.clientY - windowHalfY) / 2;
            }

            function animate() {
                requestAnimationFrame(animate);
                const time = Date.now() * 0.0001;
                camera.position.x += (mouseX - camera.position.x) * 0.05;
                camera.position.y += (-mouseY - camera.position.y) * 0.05;
                camera.lookAt(scene.position);
                
                particles.rotation.x = time * 0.2;
                particles.rotation.y = time * 0.25;
                
                renderer.render(scene, camera);
            }

            init();
            animate();
        }
        
        // AI chat simulation
        function initChatSimulation() {
            const chatWindow = document.getElementById('chat-window');
            if (!chatWindow) return;

            const messages = [
                { from: 'user', text: '아버지, 작년에 함께 갔던 바다 기억나세요?' },
                { from: 'ai', text: '물론이지. 쌀쌀했지만 햇살이 참 좋았던 날이었잖니. 네가 좋아하는 조개구이도 먹고.' },
                { from: 'user', text: '맞아요. 그때 아버지가 해주셨던 말씀이 계속 생각나요.' },
                { from: 'ai', text: '내가 "항상 너 자신을 믿어라" 라고 말했었지. 언제나처럼, 지금도 널 믿고 응원하고 있단다.' },
                { from: 'user', text: '감사해요, 아버지. 정말 큰 힘이 돼요.' }
            ];

            let messageIndex = 0;
            let isTyping = false;
            let intervalId = null;

            function addMessage() {
                if (messageIndex >= messages.length) {
                    setTimeout(() => {
                        chatWindow.innerHTML = '';
                        messageIndex = 0;
                        addMessage();
                    }, 10000);
                    return;
                }
                
                const message = messages[messageIndex];
                
                if (message.from === 'ai' && !isTyping) {
                    const typingIndicator = document.createElement('div');
                    typingIndicator.className = 'flex justify-start';
                    typingIndicator.innerHTML = `<div class="chat-bubble chat-bubble-ai p-3 rounded-lg flex items-center typing-indicator"><span></span><span></span><span></span></div>`;
                    chatWindow.appendChild(typingIndicator);
                    chatWindow.scrollTop = chatWindow.scrollHeight;
                    isTyping = true;
                    setTimeout(() => {
                        if (chatWindow.contains(typingIndicator)) {
                            chatWindow.removeChild(typingIndicator);
                        }
                        isTyping = false;
                        addMessage(); 
                    }, 2000 + Math.random() * 1000);
                    return;
                }

                const bubble = document.createElement('div');
                bubble.className = `chat-bubble max-w-xs md:max-w-md p-3 rounded-lg ${message.from === 'user' ? 'chat-bubble-user self-end' : 'chat-bubble-ai self-start'}`;
                bubble.textContent = message.text;

                const wrapper = document.createElement('div');
                wrapper.className = `flex ${message.from === 'user' ? 'justify-end' : 'justify-start'}`;
                wrapper.appendChild(bubble);
                chatWindow.appendChild(wrapper);
                
                setTimeout(() => bubble.classList.add('visible'), 50);

                chatWindow.scrollTop = chatWindow.scrollHeight;
                messageIndex++;
                
                if (intervalId) {
                  clearTimeout(intervalId);
                }
                intervalId = setTimeout(addMessage, 2500 + Math.random() * 1000);
            }

            const observer = new IntersectionObserver((entries) => {
                if (entries[0].isIntersecting) {
                    if (chatWindow.children.length === 0) { 
                        addMessage();
                    }
                    observer.disconnect(); 
                }
            }, { threshold: 0.5 });
            
            observer.observe(document.getElementById('ai-chat-demo'));
        }

        // Price tickers
        function initPriceTicker() {
            const priceElement = document.getElementById('carbon-price');
            if (!priceElement) return;

            let currentPrice = 45.32;
            setInterval(() => {
                const change = (Math.random() - 0.5) * 0.1;
                currentPrice += change;
                if (currentPrice < 0) currentPrice = 0; 
                priceElement.textContent = `$${currentPrice.toFixed(2)} / tCO2`;
            }, 3000);
        }
        
        function initExchangeRateTicker() {
            const usdKrwRateEl = document.getElementById('usd-krw-rate');
            const usdcUsdRateEl = document.getElementById('usdc-usd-rate');

            if (!usdKrwRateEl || !usdcUsdRateEl) return;

            const updateRates = () => {
                fetch('https://api.frankfurter.app/latest?from=USD&to=KRW')
                    .then(response => {
                        if (!response.ok) {
                            throw new Error('Network response was not ok');
                        }
                        return response.json();
                    })
                    .then(data => {
                        if (data && data.rates && data.rates.KRW) {
                            const rate = data.rates.KRW;
                            usdKrwRateEl.textContent = `USD/KRW: ₩${rate.toLocaleString('ko-KR', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
                        } else {
                            usdKrwRateEl.textContent = 'USD/KRW: 정보 없음';
                        }
                    })
                    .catch(error => {
                        console.error('Error fetching exchange rate:', error);
                        usdKrwRateEl.textContent = 'USD/KRW: 1,380.50 (Fallback)';
                    });

                const usdcRate = 1.00 + (Math.random() - 0.5) * 0.005;
                usdcUsdRateEl.textContent = `1 USDC ≈ $${usdcRate.toFixed(4)}`;
            };
            
            updateRates();
            setInterval(updateRates, 60000);
        }

        // --- NEW --- 모달 바깥 클릭 시 닫기
        document.querySelectorAll('.modal').forEach(modal => {
            modal.addEventListener('click', (event) => {
                // 클릭된 요소가 모달 배경 자체인지 확인
                if (event.target === modal) {
                    const modalType = modal.id.replace('Modal', '');
                    closeModal(modalType);
                }
            });
        });

        // Initializations on load
        if (typeof lucide !== 'undefined') {
            lucide.createIcons();
        }

        const mobileMenuButton = document.getElementById('mobile-menu-button');
        const mobileMenu = document.getElementById('mobile-menu');
        if(mobileMenuButton && mobileMenu) {
            mobileMenuButton.addEventListener('click', () => {
                mobileMenu.classList.toggle('hidden');
            });
        }
        
        const header = document.getElementById('header');
        if(header) {
            window.addEventListener('scroll', () => {
                if (window.scrollY > 50) {
                    header.classList.add('shadow-lg');
                } else {
                    header.classList.remove('shadow-lg');
                }
            });
        }
        
        if(typeof IntersectionObserver !== 'undefined') {
            const revealElements = document.querySelectorAll('.reveal');
            const revealObserver = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('active');
                    }
                });
            }, {
                threshold: 0.1,
                rootMargin: '0px 0px -50px 0px'
            });

            revealElements.forEach(el => {
                revealObserver.observe(el);
            });
        }
        
        if (typeof THREE !== 'undefined') {
            initThreeJSAnimation();
        }

        initChatSimulation();
        initPriceTicker();
        initExchangeRateTicker();

        if(typeof gsap !== 'undefined' && typeof ScrollTrigger !== 'undefined') {
            gsap.registerPlugin(ScrollTrigger);
            
            gsap.from("#hero h1", { opacity: 0, y: 50, duration: 1.5, ease: "power3.out" });
            gsap.from("#hero p", { opacity: 0, y: 30, duration: 1.5, delay: 0.3, ease: "power3.out" });
            gsap.from("#hero .flex", { opacity: 0, y: 30, duration: 1.5, delay: 0.6, ease: "power3.out" });
        }

        document.addEventListener('keydown', (e) => {
            if(e.key === 'Escape') {
                document.querySelectorAll('.modal.show').forEach(modal => {
                    const modalType = modal.id.replace('Modal', '');
                    closeModal(modalType);
                });
            }
        });
    });
    </script>
</body>
</html>
